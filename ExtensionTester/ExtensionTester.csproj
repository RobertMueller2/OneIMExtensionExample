<Project Sdk="Microsoft.NET.Sdk">
  
  <PropertyGroup>
    <GuiTarget>true</GuiTarget>
  </PropertyGroup>
  <Import Project="..\shared.props" />
  <PropertyGroup>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
    <UseWindowsForms>true</UseWindowsForms>
    <Configurations>OneIM900;OneIM910;OneIM911;OneIM912;OneIM913;OneIM920;OneIM921;OneIM930;OneIM931;OneIM922</Configurations>
    <OutputPath>..\build\$(Configuration)\</OutputPath>
    <OutputType>Exe</OutputType>
  </PropertyGroup>

  <Target Name="GenerateTester" BeforeTargets="BeforeBuild" Condition="!Exists('Tester.cs')">
    <PropertyGroup>
      <Tester>$(MSBuildProjectDirectory)\Tester.cs</Tester>
      <Namespace>$(RootNamespace)</Namespace>
      <Content>
using GuiExtensions%3b
using OneIMExtensions%3b
using TypedWrapperExtensions%3b
using VI.DB.Entities%3b
using VI.DB.Model%3b
using VI.DB.Sync%3b

namespace ExtensionTester {

    /// &lt;summary&gt;
    /// Autogenerated in .csproj file initially, this file is ignored by .gitignore.
    /// &lt;/summary&gt;
    internal class Tester {
        /// &lt;summary&gt;
        /// Run the test, this is required by Program.cs.
        /// &lt;/summary&gt;
        internal static void RunTest()
        {

            var session = Utils.GetDefaultOneIMSession()%3b
            var ce = session.Source().Get&lt;DialogDatabase&gt;(Query.From("DialogDatabase").SelectNone())%3b
            ce.EditionVersion.DumpObjectAsJson()%3b

            var pe = session.Source().Get(Query.From("Person").SelectNone())%3b
            pe.DumpObjectAsJson()%3b

            var p = new Person()%3b
            p.Entity = pe%3b

            p.GetDepartment(session).DumpObjectAsJson()%3b
        }
    }
}
      </Content>
    </PropertyGroup>
    <WriteLinesToFile File="$(Tester)" Lines="$(Content)" Overwrite="true" Encoding="Unicode" />
  </Target>

  <ItemGroup Condition="$(VersionNumber) &gt;= 930">
    <Reference Include="VI.CommonDialogs">
      <HintPath>$(OneIMBaseDir)\VI.CommonDialogs.dll</HintPath>
    </Reference>
  </ItemGroup>

  <ItemGroup>
    <Reference Include="TypedWrappers_$(AssemblySuffix)">
      <HintPath>$(AppDataLocation)\TypedWrappers_$(AssemblySuffix).dll</HintPath>
    </Reference>
    <ProjectReference Include="..\GuiExtensions\GuiExtensions.csproj" />
    <ProjectReference Include="..\OneIMExtensions\OneIMExtensions.csproj" />
    <ProjectReference Include="..\TypedWrapperExtensions\TypedWrapperExtensions.csproj" />
  </ItemGroup>

</Project>
