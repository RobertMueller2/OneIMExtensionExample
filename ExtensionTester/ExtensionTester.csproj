<Project Sdk="Microsoft.NET.Sdk">

  <Import Project="..\shared.props" />
  <PropertyGroup>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
    <UseWindowsForms>true</UseWindowsForms>
    <Configurations>OneIM900;OneIM910;OneIM911;OneIM912;OneIM913;OneIM920;OneIM921;OneIM930</Configurations>
    <OutputPath>..\build\$(Configuration)\</OutputPath>
    <OutputType>Exe</OutputType>
  </PropertyGroup>

  <Target Name="GenerateTester" BeforeTargets="BeforeBuild" Condition="!Exists('Tester.cs')">
    <PropertyGroup>
      <Tester>$(MSBuildProjectDirectory)\Tester.cs</Tester>
      <Namespace>$(RootNamespace)</Namespace>
      <Content>
using OneIMExtensions%3b
using VI.DB.Entities%3b
using VI.DB.Model%3b
using VI.DB.Sync%3b

namespace ExtensionTester {

    /// &lt;summary&gt;
    /// Autogenerated in .csproj file initially, this file is ignored by .gitignore.
    /// &lt;/summary&gt;
    internal class Tester {
        /// &lt;summary&gt;
        /// Run the test, this is required by Program.cs.
        /// &lt;/summary&gt;
        internal static void RunTest()
        {

            var session = Utils.GetDefaultOneIMSession()%3b
            var ce = session.Source().Get&lt;DialogDatabase&gt;(Query.From("DialogDatabase").SelectNone())%3b
            ce.EditionVersion.DumpObjectAsJson()%3b

            var pe = session.Source().Get(Query.From("Person").SelectNone())%3b
            pe.DumpObjectAsJson()%3b

            var p = new Person()%3b
            p.Entity = pe%3b

            p.GetDepartment(session).DumpObjectAsJson()%3b
        }
    }
}
      </Content>
    </PropertyGroup>
    <WriteLinesToFile File="$(Tester)" Lines="$(Content)" Overwrite="true" Encoding="Unicode" />
  </Target>


  <ItemGroup Condition="'$(Configuration)'=='OneIM930'">
    <PackageReference Include="Microsoft.Data.SqlClient" Version="5.2.2" />
    <PackageReference Include="VI.Base" Version="9.3.0-278876" />
    <PackageReference Include="VI.DB" Version="9.3.0-278876" />
    <Reference Include="Newtonsoft.Json">
      <HintPath>$(OneIMBaseDir)\Newtonsoft.Json.dll</HintPath>
    </Reference>
    <Reference Include="TypedWrappers_$(AssemblySuffix)">
      <HintPath>$(AppDataLocation)\TypedWrappers_$(AssemblySuffix).dll</HintPath>
    </Reference>
    <Reference Include="System.Drawing.Common">
      <HintPath>$(OneIMBaseDir)\System.Drawing.Common.dll</HintPath>
    </Reference>
  </ItemGroup>

  <ItemGroup Condition="$(VersionNumber) &lt; 930">
    <Reference Include="Newtonsoft.Json">
      <HintPath>$(OneIMBaseDir)\Newtonsoft.Json.dll</HintPath>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml" />
    <Reference Include="VI.Base">
      <HintPath>$(OneIMBaseDir)\VI.Base.dll</HintPath>
    </Reference>
    <Reference Include="VI.DB">
      <HintPath>$(OneIMBaseDir)\VI.DB.dll</HintPath>
    </Reference>
    <Reference Include="NLog">
      <HintPath>$(OneIMBaseDir)\NLog.dll</HintPath>
    </Reference>
    <Reference Include="TypedWrappers_$(AssemblySuffix)">
      <HintPath>$(AppDataLocation)\TypedWrappers_$(AssemblySuffix).dll</HintPath>
    </Reference>
  </ItemGroup>

  <ItemGroup>
    <ProjectReference Include="..\OneIMExtensions\OneIMExtensions.csproj" />
    <ProjectReference Include="..\TypedWrapperExtensions\TypedWrapperExtensions.csproj" />
  </ItemGroup>


</Project>
