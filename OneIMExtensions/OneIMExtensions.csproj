<Project Sdk="Microsoft.NET.Sdk">

  <Import Project="..\shared.props" />
  <PropertyGroup>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
    <UseWindowsForms>true</UseWindowsForms>
    <Configurations>OneIM900;OneIM910;OneIM911;OneIM912;OneIM913;OneIM920;OneIM921;OneIM930</Configurations>
    <OutputPath>..\build\$(Configuration)\</OutputPath>
  </PropertyGroup>

  <Target Name="GenerateExtensionSettings" BeforeTargets="BeforeBuild">
    <PropertyGroup>
      <ExtensionSettings>$(MSBuildProjectDirectory)\GeneratedExtensionSettings.cs</ExtensionSettings>
      <Namespace>$(RootNamespace)</Namespace>
      <Content>
namespace OneIMExtensions {

    /// &lt;summary&gt;
    /// Autogenerated in .csproj file from localsettings.props just before build.
    /// 
    /// This might look wrong immediately after switching build configurations but
    /// should be corrected when running a build.
    /// 
    /// Do not edit manually, any changes will be overwritten.
    /// &lt;/summary&gt;
    public static class ExtensionSettings {

        public const string OneIMBaseDir = @"$(OneIMBaseDir)"%3b
        public const string OneIMDBConnString = @"$(ConnectionString)"%3b
        public const string NLogFilename = @"$(NlogFilename)"%3b

    }
}
      </Content>
    </PropertyGroup>
    <ItemGroup>
      <Compile Remove="$(ExtensionSettings)" />
      <Compile Include="$(ExtensionSettings)" />
    </ItemGroup>
    <WriteLinesToFile File="$(ExtensionSettings)" Lines="$(Content)" Overwrite="true" Encoding="Unicode" />
  </Target>

  <ItemGroup Condition="'$(Configuration)'=='OneIM930'">
    <PackageReference Include="Microsoft.Data.SqlClient" Version="5.2.2" />
    <PackageReference Include="VI.Base" Version="9.3.0-278876" />
    <PackageReference Include="VI.DB" Version="9.3.0-278876" />
    <Reference Include="Newtonsoft.Json">
      <HintPath>$(OneIMBaseDir)\Newtonsoft.Json.dll</HintPath>
    </Reference>
  </ItemGroup>

  <ItemGroup Condition="$(VersionNumber) &lt; 930">
    <Reference Include="Newtonsoft.Json">
      <HintPath>$(OneIMBaseDir)\Newtonsoft.Json.dll</HintPath>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml" />
    <Reference Include="VI.Base">
      <HintPath>$(OneIMBaseDir)\VI.Base.dll</HintPath>
    </Reference>
    <Reference Include="VI.DB">
      <HintPath>$(OneIMBaseDir)\VI.DB.dll</HintPath>
    </Reference>
    <Reference Include="NLog">
      <HintPath>$(OneIMBaseDir)\NLog.dll</HintPath>
    </Reference>
  </ItemGroup>

  <ItemGroup>
    <Reference Include="VI.CommonDialogs">
      <HintPath>$(OneIMBaseDir)\VI.CommonDialogs.dll</HintPath>
    </Reference>
  </ItemGroup>

</Project>
